const heroInput = document.querySelector('.hero-input')
const products = document.querySelector('.product-cards')
const heroSearch = document.querySelector('.fa-search')
    // products.innerHTML = newData()
heroSearch.addEventListener('click', function() {
    const value = heroInput.value
})

const data = () => {
    const fetchedData = fetch('https://fakestoreapi.com/products')
        .then((response) => response.json())
        .then((data) =>
            data
            .map((product) => {
                const {
                    title,
                    image,
                    id,
                    price,
                    description,
                    category,
                    rating: { rate, count },
                } = product
                return `<div class="product-card" data-id="${id}">
                    <img src="${image}" alt="product-img" class="img product-img">
                    <h4 class="product-name">${title}</h4>
                    <h6>$${price}</h6>
                    <div>${rate}</div>
                    <p>${count} pieces left</p>  
                  
                </div>`
            })
            .join('')
        )

    products.innerHTML = data
}
data()


const addToCarts = document.querySelectorAll('.addtocart')
const cartBox = []
const kolo = {}

const cartDetails = document.querySelector('.cart-details')

addToCarts.forEach((addToCart) => {
    addToCart.addEventListener('click', function() {
        cart.classList.add('show')
        kolo.price = addToCart.parentElement.children[2].textContent.slice(0)
        kolo.productName = addToCart.parentElement.children[1].textContent
        kolo.img = addToCart.parentElement.children[0]['src']
        console.log(kolo)
        cartDetails.innerHTML = `
                        <img src="${kolo.img}" alt="" class="cart-img">
                        
                        <span class="item-price">${kolo.price}</span>
                       
                       
                        <i class="fas fa-trash-alt"></i>`
    })
    cartBox.push(cartDetails)
})

// const products = document.querySelectorAll('.product-card')
// const price = products.forEach((product) => {
//     product.children[2].textContent
// })
// const productName = products.forEach((product) => {
//     console.log(product.children[1].textContent)
// })
// document.addEventListener('click', function(e) {
//     if (e.target.classList.contains('addtocart')) {
//         const name = e.target.parentElement.children[1].textContent.slice(0)
//         const price = e.target.parentElement.children[2].textContent.slice(0)
//         console.log(name, price)
//     }
// })

addToCarts.forEach((addToCart) => {
    addToCart.addEventListener('click', function(e) {
        cart.classList.add('show')
        const price = e.target.previousSibling.previousSibling.textContent
        const itemPrice = document.querySelector('.item-price')
        console.log(price)
        itemPrice.textContent = price
    })
})

const deleteButtons = document.querySelectorAll('.fa-trash-alt')
console.log(deleteButtons)
deleteButtons.forEach((deleteButton) => {
    deleteButton.addEventListener('click', function(e) {
        let btnTarget = e.target
        btnTarget.parentElement.remove()
        cardTotal()
    })
})

function cardTotal() {
    let cartItems = document.querySelectorAll('.cart-details')
    console.log(cartItems)
    let total = 0
    cartItems.forEach((item) => {
        const price = parseInt(item.querySelector('.item-price').textContent)
        total = total + price
    })
    console.log(total)
}